"0","process_generation_data_folder <- function(folder_path) {"
"0","  file_list <- list.files(path = folder_path, pattern = ""\\.csv$"", full.names = TRUE)"
"0","  all_data <- lapply(file_list, function(file_path) {"
"0","    generation_data <- read_csv(file_path, show_col_types = FALSE) %>% "
"0","      clean_names() %>%"
"0","      hablar::retype() %>%  # Attempt to auto-detect and set correct types"
"0","      separate(mtu, sep=""-"", into=c(""period"", ""end"")) %>%"
"0","      mutate(end = str_remove(end, ""\\s*\\(CET/CEST\\)""),"
"0","             period = as.POSIXct(period, format=""%d.%m.%Y %H:%M"", tz = ""CET""),"
"0","             end = as.POSIXct(end, format=""%d.%m.%Y %H:%M"", tz = ""CET""),"
"0","             date = lead(as.Date(period), 1)) %>%  # Convert period to Date for summarizing and lead to match posixct"
"0","      filter(!is.na(period)) %>%"
"0","      arrange(desc(is.na(hydro_water_reservoir_actual_aggregated_mw))) %>%"
"0","      group_by(period) %>%"
"0","      filter(row_number() == 1) %>%"
"0","      ungroup()"
"0",""
"0","    # Enforce double type for all columns from the 4th onward"
"0","    column_indices <- 4:(ncol(generation_data)-1)  # Indices of columns to convert"
"0","    generation_data <- generation_data %>%"
"0","      mutate(across(.cols = column_indices, .fns = ~as.numeric(.x)))"
"0",""
"0","    # Complete date sequence for the given year"
"0","    year_used <- unique(year(generation_data$period))"
"0","    start_date <- as.POSIXct(paste(year_used, ""-01-01 00:00"", sep=""""), tz = ""CET"")"
"0","    end_date <- as.POSIXct(paste(year_used, ""-12-31 23:00"", sep=""""), tz = ""CET"")"
"0","    complete_dates <- tibble(period = seq(from = start_date, to = end_date, by = ""hour""))"
"0",""
"0","    # Merge and fill"
"0","    generation_data <- complete_dates %>%"
"0","      left_join(generation_data, by = ""period"") %>%"
"0","      fill(names(generation_data), .direction = ""down"") %>%"
"0","      as_tsibble(index = period)"
"0",""
"0","    return(generation_data)"
"0","  })"
"0",""
"0","  return(all_data)"
"0","}"
"0",""
"0","# Merge all data frames into one and make sure to retain the 'date' column"
"0","merge_all_data <- function(data_list) {"
"0","  full_data <- bind_rows(data_list)"
"0","  return(full_data)"
"0","}"
"0",""
"0","# Example usage:"
"0","folder_path <- ""NO1_generation_per_type"""
"0","data_list <- process_generation_data_folder(folder_path)"
"0","NO1_combined <- merge_all_data(data_list)"
"0",""
"0",""
"0",""
